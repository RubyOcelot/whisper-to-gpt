import os
import openai

openai.api_key = os.getenv("OPENAI_API_KEY")

def translate_by_gpt3_5_turbo(text, language_to="Mandarin Chinese(Simplified)", language_from="English", language_keep=None, language_contain=None, other_translate_context=""):
  keep_language_instruction = "" if language_keep is None else "If "+language_keep+" appears in the text, keep it as it is in the output."
  language_contain_instruction = "" if language_contain is None else "The input text may contain "+language_contain+"."

  instruction_text = "You are a helpful assistant for translation. "+ \
            language_contain_instruction + \
            "Translates the input text from "+language_from+" to "+language_to+". " + \
            keep_language_instruction + \
            other_translate_context + \
            "Aware that the input text is a transcript generated by speech-to-text and may contain some mistake due to transcribe. Also, keep the common filler words in this transcript."+ \
            "You should only output the translated text, don't output anything else, including note. "+ \
            "If input text seems to be empty, output [empty text]. "
  response = openai.ChatCompletion.create(
    model="gpt-3.5-turbo",
    messages=[
          {"role": "system", "content": instruction_text},
          {"role": "user", "content": instruction_text + '\nThe input text is: "'+text+'"'}
      ]
  )
  response_text = response['choices'][0]['message']['content']
  return response_text
